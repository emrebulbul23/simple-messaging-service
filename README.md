# Simple Messaging Service with Spring Boot

A simple implementation of Messaging Service with Spring Boot framework.

Live Demo on AWS: http://ec2-18-222-30-245.us-east-2.compute.amazonaws.com:8085/swagger-ui.html

**Tech Stack**:
* Java
* Spring Boot
* Spring Security
* STOMP
* MongoDB
* Docker

**Features include**:
* User signup and signin.
* Block user, get blocked users.
* Send and receive messages, message notification over [STOMP](https://stomp.github.io/)/websockets.
* Authorization with [Spring Security](https://spring.io/projects/spring-security)  and [Jwt](https://jwt.io/).
* API Documentation with [OpenApi Swagger](https://swagger.io/).

**Run**:

To run it on local machine

```
mvn clean package    // this will create .jar to be run
dockor-compose build    // build docker files
docker-compose up 
```

**Endpoints**:

Endpoints are documented with OpenAPI Swagger. Can be accessed from path "/swagger-ui.html". To test secure endpoints, JWT generated by the "/api/auth/signin" request should be entered to (or added to the request header) the input box visible when **Authorize** button at Swagger is clicked.

| Path | Description | Arguments | HTTP Method | Needs JWT Authorization |
| --- | --- | --- | --- | --- |
| "/api/auth/signin" | Log in to system and generate JWT. | Username, Password | POST | NO |
| "/api/auth/signup" | Sign new user up to the system. | Username, Password | POST | NO |
| "/api/auth/blockedUser" | Get the list of blocked users by the authorized user. | - | GET | YES |
| "/api/auth/blockUser/{username}" | Block user. | Username | POST | YES |
| "msg" | Get all messages or messages sent to a particular user by giving it as an argument. Messages from blocked users are not returned. | Username | GET | YES |
| "msg" | Send new message by giving recipient name and content. | Username, Content | POST | YES |
| "msg/{messageId}" | Get message by the message id. | Message id | GET | YES |

When a new message is being sent a STOMP notification message is pushed to the user, so the user can notified about a new message and request the message form the API by using the message id supplied in the notification. To receive notifications, a STOMP client needs to connect to path "/ws" at port 8085 and subscribe to the topic "/topic/public/{userId}".

A sample STOMP client written in java is supplied at `messaging-api/src/main/stomp_client`. Main method in StompClient class should be run with user id as argument.
